document.addEventListener("DOMContentLoaded",()=>{if(!document.querySelector("#sg_load_more_trigger"))return;let options={root:null,rootMargin:"0px",threshold:0};let cat=false;const catselects=document.querySelectorAll('#sg_content_select li');catselects.forEach((catselect)=>{catselect.addEventListener('click',()=>{document.querySelector('#sg_content_select li.active').classList.remove('active');catselect.classList.add('active');cat=catselect.dataset.value;document.querySelectorAll('[data-category]')?.forEach((el)=>{el.style.display='none';})
document.querySelector('[data-category="'+cat+'"]').style.display='block';loadmoreimg([],true,cat);})})
cat=catselects[0].dataset.value;document.querySelector('[data-category="'+cat+'"]').style.display='block';function handleIntersect(entries,observer){entries.forEach((entry)=>{if(entry.isIntersecting){var current=[];var items=document.querySelectorAll('.grid__item');items.forEach((el)=>{current.push(el.dataset.id);})
if(current.length==parseInt(document.querySelector("#sg_total").innerHTML)){observer.unobserve(document.getElementById("sg_load_more_trigger"));return;}
if(current.length<16)return false;loadmoreimg(current,false,cat);}});}
function loadmoreimg(current=[],replace=false,cat=false){const request=new XMLHttpRequest();request.open('POST',sg_ajax.ajaxurl,true);request.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=UTF-8');request.onload=function(){if(this.status>=200&&this.status<400){if(replace){document.querySelector("#sg_grid").innerHTML=this.response;}else{document.querySelector("#sg_grid").insertAdjacentHTML('beforeend',this.response);}
document.querySelector("#sg_current").innerHTML=document.querySelectorAll('.grid__item').length;}else{}};request.onerror=function(){};request.send('action=sg_load_more&current='+current.join(',')+'&category='+cat);}
let observer=new IntersectionObserver(handleIntersect,options);observer.observe(document.querySelector("#sg_load_more_trigger"));const locs=document.querySelectorAll('img[data-localization]');locs.forEach((loc)=>{loc.addEventListener('click',()=>{const lang=loc.dataset.localization;const container=document.querySelector(".sg_container");container.dataset.currentloc=lang;});})
document.onclick=function(event){var el=event.target;if(el.closest('.grid__item')){const request=new XMLHttpRequest();request.open('POST',sg_ajax.ajaxurl,true);request.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=UTF-8');request.onload=function(){if(this.status>=200&&this.status<400){document.querySelector("#sg_modal").innerHTML=this.response;document.querySelector("#sg_modal").classList.add('show');}else{}};request.onerror=function(){};request.send('action=sg_load_modal&id='+el.closest('.grid__item').dataset.id);}else if(el.classList.contains('modal__close')){document.querySelector("#sg_modal").classList.remove('show');}else if(el.closest('.modal__inner')){}else{document.querySelector("#sg_modal").classList.remove('show');}};})